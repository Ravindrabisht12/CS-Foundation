# 06. Memory Management

Memory management is the functionality of an operating system that handles or manages primary memory (RAM). It keeps track of each and every memory location, regardless of whether it is allocated to some process or it is free.

## 1. Logical vs. Physical Address Space
- **Logical Address:** An address generated by the CPU; also referred to as a **virtual address**.
- **Physical Address:** An address seen by the memory unit; the one loaded into the memory-address register of the memory.

The **Memory-Management Unit (MMU)** is a hardware device that maps logical addresses to physical addresses at run time.

## 2. Contiguous Memory Allocation
An early method where each process is contained in a single, contiguous section of memory.

- **Fixed-Partition Scheme (MFT):** Memory is divided into a number of fixed-size partitions. Each partition can hold exactly one process. Leads to **internal fragmentation**.
- **Variable-Partition Scheme (MVT):** The OS keeps a table of available memory blocks. When a process arrives, it is allocated a hole large enough for it. Leads to **external fragmentation**.

- **Fragmentation:**
  - **Internal Fragmentation:** Unused memory that is internal to a partition (e.g., a 10KB process is put in a 12KB partition, wasting 2KB).
  - **External Fragmentation:** Exists when there is enough total memory space to satisfy a request, but it is not contiguous; it is fragmented into a large number of small holes.
    - **Solution:** **Compaction**, which shuffles memory contents to place all free memory together in one large block. This is time-consuming.

## 3. Paging
Paging is a non-contiguous memory allocation technique that avoids external fragmentation.

- **Frames:** Physical memory is broken into fixed-size blocks called frames.
- **Pages:** Logical memory is broken into blocks of the same size called pages.
- **Page Table:** For each process, the OS maintains a page table which maps each page of the process to a frame in physical memory.
- **Address Translation:**
  - A logical address generated by the CPU is divided into a **page number (p)** and a **page offset (d)**.
  - The page number `p` is used as an index into the page table to find the corresponding **frame number (f)**.
  - The frame number `f` is combined with the page offset `d` to form the physical address.

### Hardware Support for Paging
- **Translation Look-aside Buffer (TLB):** A small, fast-lookup hardware cache. It stores recent translations of logical to physical addresses.
  - When a logical address is generated, the MMU first checks the TLB.
  - **TLB Hit:** If the page number is found, the frame number is retrieved quickly.
  - **TLB Miss:** If the page number is not in the TLB, a memory reference to the page table must be made. The page-frame pair is then added to the TLB.

## 4. Segmentation
Segmentation is another non-contiguous memory allocation technique that views memory as a collection of variable-sized segments.

- A program is a collection of segments. A segment is a logical unit such as a main program, procedure, function, local variables, or a symbol table.
- **Segment Table:** Maps two-dimensional logical addresses into one-dimensional physical addresses. Each entry has a **base** (the starting physical address of the segment) and a **limit** (the length of the segment).
- **Address Translation:**
  - A logical address consists of a **segment number (s)** and an **offset (d)**.
  - The segment number `s` is used to index the segment table.
  - The offset `d` is checked against the limit. If `d < limit`, it is added to the base to form the physical address.

### Paging vs. Segmentation
| Feature | Paging | Segmentation |
|---|---|---|
| **User's View** | The user is not aware of pages. | The user is aware of segments as logical units. |
| **Size** | Pages are fixed-size. | Segments are variable-size. |
| **Fragmentation** | Suffers from internal fragmentation. | Suffers from external fragmentation. |
| **Speed** | Generally faster due to fixed size. | Slower due to variable size. |

Some systems combine paging and segmentation, for example, by paging the segments.

---
Prev ← `05_deadlock.md` | Next → `07_virtual_memory.md` | Index: `README.md`
